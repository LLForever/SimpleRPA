package com.simplerpa.cloudservice.utils;

import com.alibaba.fastjson.JSONObject;
import com.simplerpa.cloudservice.controller.TaskScheduleController;
import com.simplerpa.cloudservice.entity.TaskDetail;
import com.simplerpa.cloudservice.entity.TaskLineDetail;
import com.simplerpa.cloudservice.entity.VO.TaskDetailVO;
import com.simplerpa.cloudservice.entity.util.DictionaryUtil;
import com.simplerpa.cloudservice.entity.util.library.tools.AiEnhanceTool;
import com.simplerpa.cloudservice.utils.gentic.Population;
import org.apache.http.HttpEntity;
import org.apache.http.client.methods.CloseableHttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClientBuilder;
import org.apache.http.util.EntityUtils;
import org.springframework.web.client.RestTemplate;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.concurrent.atomic.AtomicInteger;
import java.util.stream.Collectors;

public class TaskScheduleAllocator {
    private static final String SERVER_HOST = "http://192.168.103.";
    private static final String END_POINT = "12022";
    private static final String CMD_TAIL = "/panel-task/run_task", GET_COST_TAIL = "/schedule/get_cost";
    private static ArrayList<String> serverList;
    private static String[] stServer;
    private static final AtomicInteger pos = new AtomicInteger();
    private static final ArrayList<TaskDetailVO> waitingQueue;
    public static final ArrayList<String> machineName;
    public static final ArrayList<Double> opt_pso_list, pso_list, chaos_pso_list, ch_pso_list, gene_list;

    private static String schedule_type;
    private static Integer startStatus, algorithm_type;

    private static int TaskSendThreshold = 0;

    static {
        opt_pso_list = new ArrayList<>();
        pso_list = new ArrayList<>();
        gene_list = new ArrayList<>();
        chaos_pso_list = new ArrayList<>();
        ch_pso_list = new ArrayList<>();

        waitingQueue = new ArrayList<>();
        pos.set(0);
        machineName = new ArrayList<>(Arrays.asList("master", "node1", "node2", "node3"));

        TaskSendThreshold = 21;
    }

    public static void removeServerlist(int i){
        int j = 0;
        for (; j<serverList.size(); j++){
            if (stServer[i].equals(serverList.get(j))){
                break;
            }
        }
        serverList.remove(j);
    }

    public static void addServerlist(int i){
        serverList.add(stServer[i]);
    }

    public static Integer getAlgorithm_type() {
        return algorithm_type;
    }

    public static void setAlgorithm_type(Integer algorithm_type) {
        TaskScheduleAllocator.algorithm_type = algorithm_type;
    }

    public void initParams(Integer num, String[] ips){
        serverList = new ArrayList<>();
        stServer = new String[num];
        for(int i=0; i<num; i++){
            serverList.add(SERVER_HOST + ips[i] + ":" + END_POINT);
            stServer[i] = SERVER_HOST + ips[i] + ":" + END_POINT;
        }
    }

    public TaskScheduleAllocator(){
        String[] ips = {"116", "117", "118", "99"};
        initParams(ips.length, ips);
    }

    private void LunXunSchedule(ArrayList<TaskDetailVO> list) throws Exception {
        for (TaskDetailVO item : list){
            int i = pos.get() % serverList.size();
            pos.incrementAndGet();
            SendTask(item, i);
        }
    }

    private void TanXinSchedule(ArrayList<TaskDetailVO> list, JSONObject costInfo) throws Exception {
        for (TaskDetailVO item : list){
            Double minCost = 1e50;
            int min_i = 0;
            for (int i =0; i<machineName.size(); i++){
                String name = machineName.get(i);
                Double mCost = costInfo.getJSONObject(name).getDouble(TaskCostCountUtil.COST_VAL);
                if(minCost - mCost > 1e-10){
                    minCost = mCost;
                    min_i = i;
                }
            }
            SendTask(item, min_i);
            String name = machineName.get(min_i);
            costInfo.getJSONObject(name).put(TaskCostCountUtil.COST_VAL, minCost + TaskCostCountUtil.getSumCostById(item.getId()));
        }
    }

    private void LiziqunSchedule(ArrayList<TaskDetailVO> scheduleTaskList, JSONObject machinesCostInfo) throws Exception {
        Long[] ids = new Long[scheduleTaskList.size()];
        for (int i=0; i < scheduleTaskList.size(); i++){
            ids[i] = scheduleTaskList.get(i).getId();
        }
        double[] x_low = new double[ids.length], x_up = new double[ids.length];
        for(int i=0; i<ids.length; i++){
            x_low[i] = -4;
            x_up[i] = 4;
        }
        JSONObject performanceJSON = TaskScheduleController.getPerformanceJSON();
        JSONObject run;

//        System.out.println(performanceJSON);
//        System.out.println(machinesCostInfo);
//        System.out.println(Arrays.toString(ids));
        double[] scheduleAns = new double[0];

//        PSO pso = new PSO(x_low, x_up, machinesCostInfo, performanceJSON, ids, 1);
//        long startTime = System.currentTimeMillis(), endTime;
//        run = pso.run();
//        endTime = System.currentTimeMillis();
//        double[] best_sovs = run.getObject("best_sov", double[].class);
//        System.out.println("******************************** Std PSO ********************************");
//        System.out.println("time consume: " + (endTime-startTime));
//        System.out.println(Arrays.toString(best_sovs));
//        System.out.println(run.getDouble("best_fit"));
//        System.out.println("******************************** END ********************************");
//
//        if(ids.length > 1) {
//            pso_list.add(run.getDouble("best_fit"));
//        }

        long startTime, endTime;
        PSO pso = new PSO(x_low, x_up, machinesCostInfo, performanceJSON, ids, -1);
        startTime = System.currentTimeMillis();
        run = pso.run();
        endTime = System.currentTimeMillis();
        double[] best_sovs = run.getObject("best_sov", double[].class);
        System.out.println("******************************** chaos PSO ********************************");
        System.out.println("time consume: " + (endTime-startTime));
        System.out.println(Arrays.toString(best_sovs));
        System.out.println(run.getDouble("best_fit"));
        pso.getFAndG(best_sovs);
        System.out.println("******************************** END ********************************");

        if(algorithm_type == 3){
            scheduleAns = best_sovs.clone();
        }

        if(ids.length > 1){
            chaos_pso_list.add(run.getDouble("best_fit"));
        }

        pso = new PSO(x_low, x_up, machinesCostInfo, performanceJSON, ids, -2);
        startTime = System.currentTimeMillis();
        run = pso.run();
        endTime = System.currentTimeMillis();
        best_sovs = run.getObject("best_sov", double[].class);
        System.out.println("******************************** ChPSO ********************************");
        System.out.println("time consume: " + (endTime-startTime));
        System.out.println(Arrays.toString(best_sovs));
        System.out.println(run.getDouble("best_fit"));
        pso.getFAndG(best_sovs);
        System.out.println("******************************** END ********************************");

        if(algorithm_type == 2){
            scheduleAns = best_sovs.clone();
        }

        if(ids.length > 1){
            ch_pso_list.add(run.getDouble("best_fit"));
        }

        pso = new PSO(x_low, x_up, machinesCostInfo, performanceJSON, ids, 0);
        startTime = System.currentTimeMillis();
        run = pso.run();
        endTime = System.currentTimeMillis();
        best_sovs = run.getObject("best_sov", double[].class);
        System.out.println("******************************** Optimized PSO ********************************");
        System.out.println("time consume: " + (endTime-startTime));
        System.out.println(Arrays.toString(best_sovs));
        System.out.println(run.getDouble("best_fit"));
        pso.getFAndG(best_sovs);
        System.out.println("******************************** END ********************************");

        if(algorithm_type == 1){
            scheduleAns = best_sovs.clone();
        }

        double[] doubles = NSGA_III(machinesCostInfo, performanceJSON, ids);

        if(algorithm_type == null || algorithm_type < 1 || algorithm_type > 3){
            scheduleAns = doubles;
        }

        double[] optList = new double[]{-0.7925942391242499, 2.1834612839941343, -1.9208352406765228, -2.823967141698448, 1.6527014166740734, -1.8787105660976149, 1.7432333078411697, -1.0796162648632621, 0.7098097791467012, -1.5290096566262341, 1.7941093387473912, -2.2069550109401384, 2.505482322502795, 0.6554604617257239, 1.3461929725675126, 2.439600631258518, 2.615077409346236, 2.7437563853504274, 4.0, -1.5835323645800892, 4.0, 1.7850401694745723, -1.5127297656349976, -4.0, -1.2302299983351785, -1.9669854510648987, -3.1034697173438834, 4.0, -0.43543412849286556, -0.5412149949176013, -4.0, -2.044713640551217, 1.1993315482387847, 0.04371234795554424, 1.5972122336779435, 1.62161653594318, 2.213977887206915, -0.5333003347344811, -2.720510548458529, -2.5448580976287705, 1.5813822163965874, -4.0, 2.900124569901982, 4.0, -2.6128361203788693, -3.341490582312457, 1.115099121827975, 2.4774195623069035, -2.7228550885206095, -4.0, -2.704450253764074, -0.8800769457477782, 4.0, -2.0572483053134, 1.6804904751282943, -2.0998845769928414, -1.323009268290788, 2.5928712623332593, 3.2920039341415928, 2.0944230233296253, 0.4697461719596394, -4.0, -3.0804106254689367, 2.457475660807968, 3.328018333783797, 4.0, -3.498901661645386, 0.8195017601414369, 2.4703107484910234, 0.8757143368203016, 2.370196756955136, 2.5238252633186344, -0.16120378375860933, 4.0, -1.9587823810342884, -1.2753824682634887, -2.695108055750793, 2.001865450408804, -0.2539491149141371, -2.5315729272812337, -2.157880575577769, -4.0, -2.409730384255302, -1.7408996517253161, -1.122344509051182, 0.15566769025182137, 4.0, -4.0, 1.9607790515319214, -0.8208775608722374, 0.4212450765207606, -2.400336935688592, -2.302227811422141, -4.0, -3.322730895176278, 0.16512403339256865, 4.0, -0.8736772455802088, 0.7028669320513821, -1.5672322015963913, -2.0190659588380324, 1.4565709177921906, -4.0, 1.054040986103017, -1.0294043466915088, -0.08922651350181543, -1.2022489090638948, -2.8906287734067595, 2.5751068020378844, -1.0518370510530581, 2.454457999689855, 0.3555990151092374, 2.5052391492719916, 2.540638803875593, 1.1927644832230877, -2.284830163219305, 0.7345830540790814, -2.0841474665642643, -2.6836672669211707, -0.8727517416356066, -1.7541489233949608, 1.3712064824314396, -1.4942802413207956, -4.0, -0.7618811688013364, 1.5334047030482822, -4.0, -1.1576071437579294, 2.92542184859008, -1.3241311709872283, 1.766067919077615, -2.134486283270409, -2.4994585810133527, 0.9452034564338005, -1.1268570394257602, -2.1516755355833244, -0.38400874671311935, 1.4530787826282814, -2.624955095174871, 4.0, -0.3195996182665718, -1.350176030162931, -1.5988591335806805, 2.033704557366998, 4.0, -0.7273837583533508, -3.331421405968266, -1.991690671703426, 2.583819101862334, 1.3639322704019763, -2.328079360001406, -0.25441882232661117, -1.7028082679983214, -0.27549216900288076, 2.182885785558565, 2.172877148225295, -2.468216154079335, 4.0, 0.9402637865927713, 3.0662786660213324, 1.838770666913049, -4.0, 2.2498111644776193, 1.971211560299536, -0.9807943120777353, -0.22280342186133417, -0.08940431650682745, -3.2621275196155866, -0.665348211547803, 1.7504229913914673, -0.42052635657820225, 1.968433811336428, 2.6207486580262205, 1.6738686097233497, 0.6801846846318524, -0.6116068590971562, 1.3522083601867372, -0.4409843066808681, -2.0871230250405253, 3.510205371609742, -1.919780710848557, -1.5868628742641862, -2.4743994287325144, -2.7119369201091392, -1.9388679872278543, 1.1441346824323682, -4.0, -2.3320360970754144, -4.0, 0.8695262970092354, 2.8576096024421203, -1.6741389276353773, -1.6492466407674709, 2.744441687160816, -2.511934216534863, 1.121788688994183, 0.9316323743651536, 0.8504660711050407, -0.75832346365508, 0.1445910013645233, -0.4597115391140023, -0.6743540332428954, 4.0, -2.2642550378149853, -3.0456362402410355, -1.6444693689019894, 1.5719013473800276, -2.4931244570506186, 2.8476723321393185, -4.0, 1.5658526729466857, -2.6216846896998813, 1.6249749585747078, -2.1682752846134377, 3.531000884796871, -0.5948150412432798, -2.6594562028521564, 1.075427066246639, -0.09430375317072748, 1.449951173814384, -1.4897781348649142, 1.1736776266404634, -1.426517228568541, -0.11430197042992962, -4.0, 4.0, -1.578207529632591, 1.5283461765605688, -1.0487923690266747, -0.29762017301496646, 4.0, 1.9844464713417282, -3.343587762287839, 0.958627928601935, 1.4594882962662337, -0.9593091255957817, 2.394006688041969, 0.02039882644316393, -3.6, 1.376220402628099, 0.38150481843467965, 4.0, 1.533141312544836, 2.6479457003363773, 0.6426759002169209, -0.6528078916871296, 3.279267728786627, -2.636355675814351, -4.0, 2.1032186322290234, 1.5283751265907057, -1.149477182332256, 0.4341312537859061, -1.514509791779958, 0.14022599467932917, -3.305526569290401, 4.0, 1.0853910299145988, -0.8070291674718708, 2.429508443425344, -0.7016394150077964, -2.4607090160828324, 3.3941423284728476, -3.0569160472463484, 2.4980615153133066, 2.3335845345349178, 1.7578211068849048, -0.28190628185197797, 0.6942873859923183, -1.0183472043532258, 4.0, -4.0, 3.004752961269653, -0.9964755421745816, 1.540416791212269, 0.9875230446321692, -2.0970495234718207, 2.809829353871095, -2.0462068312755384, 0.24244880942814195, -1.3623599506473707, -0.8330755706860898, -0.3437641204956987, 2.0215883361068405, -2.0178236471121753, 4.0, -4.0, 4.0, 2.774556557055008, 2.228087765200861, 0.5287207754605393, -4.0, -2.472929785659506, 0.3474667560069009, 4.0, 4.0, -2.0398420701473614, -1.0592121813730997, 1.5562991825887291, 2.2965595684504203, -0.7830326026201179, -2.461661833214184, -2.8799771114986443, 0.8795012268778049, 0.4828162836434723, -4.0, -1.6197407227595293, -1.9024376238498775, -2.341780119855648, -4.0, 0.2842867582112175, -2.5055273085485608, 1.3430306073090525, 0.8092762409197433, -4.0, 0.05042937093824995, 4.0, 2.399670607492393, 2.1629100006683313, 1.6355967165774388, -3.0472469254949544, -1.7430828409550823, -2.1375431286126316, -0.664244162057566, -4.0, -1.5633643521350973, -0.5900017522494492, -2.7650164874991123, -0.04067865648407931, 0.780235473656996, 4.0, 2.89543294634115, -1.9091761780746768, 1.3723472852242429, 3.3258258712985316, -1.0461760294772977, 4.0, 2.596033558048953, 4.0, -0.31817794475237493, -0.0684474661037936, -1.673567321750376, 2.827960299749547, -2.774556557055008, -0.7067118234531233, 1.0780936842884665, -4.0, -2.7431489602286083, -0.5135167780696059, -1.9495750891849601, -1.3667920335371293, 2.531270601147343, 2.4720918554758784, 1.6986145398446784, -4.0, -2.487162510694473, -3.0913720286143223, -1.1693150123082698, 1.5113669426371372, -2.424462158076728, -1.7134812189270923, -0.004335978080198477, 2.534514270906585, -3.355615914537476, -2.582230260209734, 0.09306998636494745, 3.2914413566382965, -1.932258589528384, -4.0, 1.8182106603963328, -0.3899250132421066, 4.0, -0.8008609003780003, -4.0, 0.31432109882737613, -0.061555526644856084, 4.0, 2.4478198506176834, 2.5060288677576237, -4.0, 0.136525129746066, -4.0, 4.0, 4.0, -2.1112171094919803, 2.920036306540319, -2.7498415676574415, 1.5412683873819821, 0.10866175634494835, -2.240378748835751, -3.3159748469020878, -1.9767512613493252, -4.0, 1.694752225473198, 0.5776460821447362, 0.8167696206780694, 0.584441901543578, -1.1658545445513924, -1.784475792783601, -4.0, -2.7789420835334093, 0.32101587464023196, -1.0526842782173766, -4.0, -0.08482866211225659, 1.489618721484362, -2.158826848402475, -2.895582849285242, -2.3470796972778722, -2.2207288233467977, 4.0, -0.5651265233199501, -2.0672870466697386, 2.501138288169317, -1.9730751499254566, 2.9091358325096035, 0.9116622482833056, 2.6570374622311514, -2.5359995521418277, -4.0, -1.6212348159917829, -2.9420580763505066, -1.153950600007876, -0.25017101676551967, 0.7441604724379433, 3.356402652229355, 4.0, 0.21053732640437106, -0.6832144641187814, -2.2664084731678242, -3.5073642479988654, -2.683907155315306, -4.0, -0.29878523824332937, -2.0092508334843404, 0.7873448902455905, 4.0, 4.0, 0.16559208866206088, -4.0, -0.7039267075800507, 3.541815919083428, 2.6112868323126204, 2.359253186910563, -0.6008974026141254, -2.6302246568752468, -4.0, 2.322424330832952, -1.9666861518302636, 1.5228054748146893, 4.0, 0.8209564765197587, 2.5444291692220156, 0.45313652871461085, 3.230717987410754, -2.638421179667951, -2.8608460047933475, -2.109864147653546, -2.477712150131877, -0.2681883582005705, 1.0534676884205638, -4.0, 1.8383498084695031, -4.0, 2.4015868605737927, -0.33466858906295804, 2.6554055040354756, -2.5192838023804316, 0.33672903608635063, -0.3230933639403146, -1.737000751025795, -2.5117845777597037, -1.4344860775222188, 2.440686094117547, 4.0, -4.0, 0.4225916285848431, 0.34762779053936876, -2.3883341736072636, 0.11559318420928322, 1.982476772469285, -3.003678542611639, 1.90042488027569, -1.8659642093488575, 1.7002914919385446, 2.0069997339647223, -0.7664813478324406, 3.380494895396511, -2.774556557055008, -4.0, 3.0573064306217637, 0.30471378651678804, -1.8808021899751324, 0.14624810260794396, 2.182247525288826, 4.0, -4.0, 2.252741969615737, -2.5251084411657576, -4.0, -4.0, -3.362096451282248, -1.1988291071770854, -1.8926249379765063, -1.415636822835186, -1.988133639790843, 0.5192838426281918, 2.494403970362214, -2.239219974028538, -0.13675837274150704, 4.0, 2.560327596028568, -0.23128829426409003, 0.4578261860970514, 1.9079637105733371, -2.683183587274679, 4.0, -2.1763892736896673, -0.3202288838734455, -4.0, -4.0, 0.2813832533645262, 0.35928808464057405, -4.0, 4.0, -1.8272735189203098, 2.774556557055008, -4.0, -2.8942391922020922, 1.121285875155474, 0.9624104221422124, -2.460762608117975, 0.11550801891618012, 2.2310716957501664, 0.7665427845267234, 0.20606773691680325, 1.8723610943876385, -4.0, -2.8929313138457573, -2.375159864145921, 0.9255046323026901, -0.27200615191909805, 4.0, 1.5280246735171137, 4.0, 1.4812595256901795, -0.25698509838794725, -0.4585080602967816, -0.6230059850633296, 3.0361852339934505, 0.8068740990962567, -1.1483092498750453, -1.3029011863964097, -4.0, -0.6579625567004056, -0.5870140121656304, 1.18426605487699, 4.0, 0.6362803443447879, 2.844264208440089, 4.0, 1.6349235799212236, -1.4920971117279602, -1.8034447521810824, 1.2556604061635301, 0.12383754608706399, 1.179828163120038, -2.774556557055008, 0.05179203770254737, 4.0, 1.6176162254057398, 4.0, 2.3248634922265317, 4.0, 1.3224606054977195, -0.558583378849445, 2.5942129993414835, 4.0, -2.04302334187552, 1.5711522279097667, 0.19441715137134552, 0.8447896674785287, -0.6074731977626027, -2.9300157806086107, 0.10966121856564914, -3.001462464543332, 0.12744757437807175, 3.6, -1.5432971975253686, 0.8043619810312309, 4.0, -1.3325895315743888, 2.6080751614268043, 2.073078737665403, 1.714741082389105, 4.0, -1.9537065579791135, 2.506433533904697, 2.4802479628646634, -0.6795814187873287, -0.6161107627642262, 0.8817659322678396, 2.504543184886765, 2.543773168576976, -1.0349359561011002, -0.6587180741077617, 0.24085639592584152, -0.9116454445970612, -1.6360723157549275, -0.5762549238526276, 2.963956238880112, -1.0986917659737028, 2.7080837789482453, 0.36069819503458567, -0.16405613010328746, -4.0, -1.80453885260829, -0.4399049540609744, -1.0126363478257567, -1.2542126755045195, 2.1889623866277783, 1.0724201575166745, 2.982203403844414, 2.1808036823234254, -0.7119255996638377, 2.2075161709662083, -0.5684896254267106, -4.0, 4.0, -1.9665888534739993, -0.6352267690304525, 2.1302977437483546, -2.1401934939646283, -1.2465715715626815, 1.8042554595947045, -1.085374041040015, 0.5916157108859001, -2.0857275532242086, -0.6034337442563974, -0.1714930871325525, -2.4156538706789514, 2.894428918462409, 2.774556557055008, 1.0312510034579059, 4.0, -1.3915658512081257, 1.0621046346334642, -4.0, -1.340695299772613, 1.8496070826349473, 2.2904945772688903, -2.588455301532213, 0.16097247396290149, -4.0, -2.020708113214913, 4.0, -4.0, -0.2501955399841266, 1.261316176604777, -1.3241171882914704, -2.9174602781930865, -0.5839117332953337, 4.0, -0.02240799869843968, -1.7971792329538838, -2.1382027901325653, 0.28320936968237986, -2.114247206313133, 1.717718752495132, -1.3644967248790663, -1.4690425669570033, 2.3835746326115865, -1.9798177573438234, 1.0611828877718437, 0.6645311075566867, 3.470525321417413, 4.0, -0.5393983066042356, 2.6070142328244716, 2.2055408713586306, 2.5748916369371346, 4.0, 1.7468321496681314, -2.1453846288262555, -1.177986305512165, -0.2728133350224802, 4.0, -1.4726858321125995, -0.8992457882553315, 1.3683085394039527, 4.0, 0.1251504312624172, 1.4659296430100226, 4.0, 0.0738424527691135, -2.1883403757517472, 3.20783259378553, -0.9116434825574843, 4.0, -2.774556557055008, -4.0, 0.8836765863546487, -4.0, -0.9533830621183853, 2.4009768212782454, -1.3143375204891439, -0.051415014268464176, -1.1714313666987355, -1.8310339431592262, -1.62741329757701, -3.0530819144398635, 0.7398742163900669, -4.0, 4.0, 1.6106338381900311, 3.238185746477284, -2.36018751511347, -1.0020134348634404, 0.7409823178475825, 4.0, 1.4004413945499665, 4.0, -0.6976636787980857, 0.03874064602323357, 2.058443371323439, 4.0, 4.0, 0.5027517691624209, -4.0, -2.3734975740526574, -2.369071612581609, -4.0, -2.8380072454754326, 2.3199204442418067, 4.0, -4.0, 3.1651563347449905, 0.41185503493564046, -4.0, -0.48685698126609467, 2.56400849034546, 4.0, 2.06732703477912, -4.0, 0.5848479168980258, 0.623385016711617, 4.0, -2.247141891131357, -4.0, -0.004393069797634652, 1.5635131149296586, 1.7226962859975319, -0.8576741376898358, -4.0, 4.0, 0.39757804521734164, -3.4989019199385103, 2.1640479574324463, 0.42417747262536354, -3.5110243186530283, -1.135087188501064, -4.0, 2.236963483497418, 4.0, -4.0, -4.0, 1.265817208311001, -1.9791676237604745, -3.190539294403518, -4.0, 1.3338372715762261, -0.27310092461883506, 3.2334346559648717, 2.91954232518173, -4.0, 1.4637123300662704, 1.374295132232483, -0.9792188019421824, 0.15113022873061366, 0.438523721221284, -1.2284544432421036, 1.6234117574181959, -2.9467905612684526, -0.8187553662184995, -0.28045245769166016, 4.0, -1.6351527941687363, 4.0, 1.3187844104321487, -0.34007224596717855, -0.9725804092406906, 1.2740042669766125, 3.4995081722303967, 1.9000143516675188, 0.4317686312739202, 2.745252011492634, 0.6800408683308997, -1.6543990368769428, -1.141953366514315, -2.821233033816025, 2.000575244877927, 0.43883727793527605, 0.6106240457343672, 4.0, 2.2296253138803017, 1.452240240187895, -0.9581644277211447, -1.1793623298418319, 0.34259260037847883, -3.35992911974855, -0.35782440585902364, 0.707154378016164, -2.2746952268438787, 0.9630726151130885, -0.9427102305859847, -2.0871094053744033, -0.3372864175417689, -2.4508562225176966, 1.724463609118955, -1.7473548216038988, 1.7303140235689973, 2.944243117049306, 2.774556557055008, -4.0, -1.185668698826663, -0.6819972205728231, 2.907880231917418, -2.6242264664395183, -0.8449673012223313, -4.0, 4.0, -3.499049971522624, 2.4537003124712164, 2.1837865884445034, 0.275700409275644, 1.0433871829597476, -2.7498415676574415, 0.6681687422680804, 2.796885519070919, 4.0, 2.8750538408566406, 2.5183455248083293, -1.1486767088814356, -0.038398810598702426, 2.774556557055008, -1.5924833719870537, 0.22206093621469913, 4.0, 4.0, -2.701609779052424, -4.0, 2.342615408899749, -1.9989999343305642, 0.5176656985597222, -0.3877374961948974, -4.0, -0.4517728396214863, -0.3585408962365423, -4.0, -1.8128917142990475, 4.0, -0.24942342821048036, 0.1442929639114594, -0.6194192867834816, 1.8404179236925726, 1.1855203941485701, -4.0, -2.4765780982727863, 4.0, -1.9102506053356254, 0.6285626402046155, -2.36710612133576, 4.0, -2.030957517115352, 1.8674066982047535, -1.8818833056029758, 3.1185354255896294, 1.6251030629947605, 2.973082241267722, -3.6, 0.9073222579189236, -4.0, -4.0, -1.5125742952739825, 0.1494516511414129, 1.4374384127919164, 4.0, 2.597937898098192, 4.0, 2.2124056565067924, 4.0, 1.8924173971043694, 2.459878345117017, 1.3966762415271754, 0.5886022779999032, -0.6419047190407042, -2.23870525055788, 1.2712334573476347, -4.0, 4.0, 3.4730308982702964, -4.0, -4.0, -2.6266990786535365, -4.0, -4.0, 2.7498415676574415, 1.022744730536019, 0.21353367425574765, -3.301007403954599, -1.6190680276014677, 2.717260520659215, -2.812989850572167, -0.5186172192987414, -4.0, -1.2490680707881014, -1.616383226999165, 0.5649214607809587, 1.2747362779057076, -1.4541510158837583, 1.7278335522053752, -3.6, 1.9912734706383848, -4.0, -2.9847899218233405, -4.0, -2.858115292248322, 4.0, -0.9703106923885418, -2.76703700702947, 0.23625727525668505, -2.10817850723783, 0.056626729515251606, -1.6484896760637433, -0.5515909679537131, -4.0, 2.6302246568752468, -2.8712629779335166, 3.1823725283572513, 1.9970952249482203, -2.9999377722032614, -0.6012449111882067, -1.8014387779331775, 1.5744203494619637, 1.5051924188700787, -4.0, 4.0, -3.50704136819805, -3.17036168893675, 3.0832819399236437, 4.0, -3.07994038471434, 4.0, 1.4254220742611359, 2.4130712486217787, -1.6138520733379127, 1.5153079929363087, 1.488753737233587, 2.7205435277331835, -4.0, 0.5418663419455073, 2.299246161293568, -0.2965783885890416, -3.002419025205283, -1.1617203166918262, -4.0, -2.5682090320704467, 0.6818350322190938, -2.0099718780696563, -1.1089853666315213, 4.0, -0.4144991687601276, -2.5846074020052328, 4.0, 0.5065204137589343, -0.4139734169030347, -0.23579737017573998, 0.9937378643870294, -0.2731134340956277, 2.39601489591972, -4.0, 2.2950309452156166, 2.774556557055008, 1.495128573114779, -0.454716604076268, -1.5515083607609768, -4.0, -1.6557533188867273, 4.0, 3.454916854994672, -1.2540808016810276, 2.5139644716009544, -0.7773253804472487, -2.2944019202837445, -2.225265514352703, 0.9446568893772808, -2.3069852951523053, -0.4642395509323678, -0.5465412032209633, -2.9590179312049454, 0.18411671000468144, -3.321719740936899, 1.9861377670449532, -4.0, -1.365443635819954, 1.4729724087138645, 4.0, 1.7142798074604058, 0.9954619822188369, 1.7573477328281477, 2.2829366313216353, -1.0658157333836447, 0.25963722024334746, 0.24909713676226664, 4.0, 2.657721475663351, -0.7623101731179707, -2.7745802989743065, -2.8372855320486265, 0.07361191738420347, -0.10375071397760383, 0.3227273965918146, 2.5278633632871212, -3.6, -0.09605065141606173, -4.0, 1.5201724492188915, -1.5849913558166242, 3.325546016850767, 4.0, -0.9782764271595616, -4.0, 1.3372954093085339, -4.0, 3.0291438425961528, -2.6028880650305095, -4.0, -2.6598515908265923, -1.6608944220296231, 4.0, -4.0, 0.1370543743928493, -0.7391047121586184, 0.23933103184603344, -1.7627087490743156, -1.0624140713560657, 1.288937397303632, 1.0386113765285496, 1.2377957496666272, 1.5430139658556963};
        double[] chPSOList = new double[]{0.0, 0.0, -4.0, 4.0, -4.0, 4.0, 0.01637445822238004, -4.0, -4.0, -3.883917432658923, -2.5996188376325398, 1.7491960210786308, 2.987826907871213, 0.7634441335015955, 0.5496618392440891, 2.568986955691636, -2.3426947249033163, -3.9165843090299455, 3.972638642054679, -3.086707324600286, 4.0, -1.7471838484991977, 3.968075298466597, 4.0, -0.6648152547848027, -1.2766485659231523, 4.0, -2.0144937918789156, 2.161886319660627, -4.0, -3.09353242496227, 3.3983790195689965, -2.0565016487510577, 0.5218757928209574, -0.9629686070553953, 2.566977611509007, -4.0, 3.413402849382112, 1.1420759226420971, -0.23971518985868503, 0.36837195476771656, -2.268803679105105, 3.014162065546887, 2.915027755260496, -0.4557879720373616, 0.3616072328886861, -2.6610282227657005, 1.9008391677398224, -0.04663750033333832, -0.27709541053488124, -3.564466776466897, 4.0, 4.0, -3.9317003062605775, 0.5956955642511044, -3.2565648088224886, 2.045139229422914, 0.6912559282077722, 0.0495895931513674, 1.1141806366548677, -0.6380591969743848, -0.9347194192391166, -2.0076658746881373, 4.0, 1.9107390206599335, -2.2301006013415905, -3.2746381812631946, -1.8959966355444902, -0.30031785564783825, 1.0571144627931324, -4.0, -1.4755641371671224, -2.531289083286368, 0.4967972551665496, -0.6653113071700633, -4.0, 1.0570893756099358, -2.505670224114151, -3.569768870876178, 2.3461603666559863, -2.4771145296750827, -2.6928834935676913, -2.9274445097282484, -2.1556098540995667, 1.85030343453199, 1.1925692257080094, 2.658614648648617, 1.4776281483905491, -1.9961000215331623, -0.8456244753328488, 0.25664515215888317, -1.8264075749317858, 0.18413005213266007, -2.528510077049076, 2.3378463870518322, -1.9912115880394676, 3.833372571462798, 2.802936250115972, -0.6070160506185128, 3.493756349016999, 1.1978378940578989, 1.17976167912575, 1.3081815988333956, -2.5442637485763098, 2.408642240718488, 4.0, -1.6560826740736319, -0.683881860334006, 3.805426034185922, -1.8355102349998071, 2.4967312951323435, 4.0, 2.0352506999440028, -1.8089877908284082, 2.069844651766582, -0.35993868346393265, -2.4206123669236614, -2.3413374024534015, -3.9513916774472087, -2.1893042909232174, 0.6295533512853994, 1.2061021684505786, 1.1388551695488285, 2.4163219756239553, -1.8872183782096719, 1.932261906725936, -2.0295718098151325, -0.5769865172748614, 1.6601310922844779, -1.0727133709004422, -1.0125790655765248, 1.2015070100714136, -1.0324763817701605, 2.3456550011812487, 2.4263909675550934, 3.3243617479205945, 4.0, 0.9792826425256186, 0.8636719018135475, 2.277221660657938, 3.394457273587476, 4.0, -0.47357727883530554, -2.3306261932899304, 3.618743188547843, -0.9020984015423564, -3.137361086744732, 2.1873229399609313, -3.1273244121257897, 0.13402528649947185, 0.1395759469578738, 2.2006521209382326, 3.006905268581894, 3.8811194832364593, 1.194674960415635, -0.18258856829129758, 2.3726857919349524, 1.4319029599228756, -0.03416449016566463, -0.11073134655633952, -3.7219345075195513, 3.6945828030950554, 3.0515046479461843, 0.8046129382883116, -1.9466380751103716, -1.3689022639994448, 1.5769722958052774, 3.6914492262956, 3.6923975377353733, 3.7923828809906377, 4.0, 1.1961745431041686, 3.9415133129933966, -4.0, 0.035594392495515735, 1.3762788745473062, 0.6377036874469525, 0.6715788652990798, -3.3075534838974083, -0.3180366395628909, 3.7327099985254493, -1.8562236854814966, 1.1002714073406386, -3.9961719815448116, 0.5254575639575182, 3.18787644838147, 3.109868395382896, 3.207338134765909, 3.928541381073886, 3.6358662995605457, 1.8520181947182452, 0.13362848304786315, -3.630508508100907, 2.18687749488213, -3.1466651137789428, 1.1305054512085582, 1.7124686693369622, 0.15292821287607533, -0.6340134206387216, -0.5409125790764152, -2.4583827269711507, 2.4031680861898614, 3.3588352884437485, -2.3642729097299466, -0.48735450765796384, 0.0594159074270497, -1.8350010560633763, 0.5098480108573973, 0.296080299487694, 1.7756266322113377, -1.472715548068867, 3.0854162549452337, -2.4286305364952443, 0.47923612880732913, -1.6623001437870197, 3.857173154575364, -3.6300182837065065, -0.7259827866861314, 2.8340947162435928, 2.325831742736208, 1.227017212429028, -2.787875233587379, -1.2271216924124888, -4.0, 0.2046453988747325, -2.1285064121726887, 1.3139645052158413, -4.0, 3.3442593950444435, -1.0289165784585672, -0.9470976698420155, -0.438290610953789, 1.7127104499947627, 1.444599323081816, 3.0140451118864693, 0.4855676374222127, 2.116852895938461, -3.340328719903349, -1.4340017977308102, 1.693054987727415, -2.195071635986945, -2.928564488642416, -3.192722889076015, -2.605111634579366, 2.6122246238616627, 1.281307996928289, 2.180531545815169, 2.235041329046106, 2.7653294841048512, -3.0045562868542883, -1.131919968868936, 2.7975286176482625, -1.4294173986178567, -0.3759563762023556, 0.6912620602555101, 0.2326391963405561, -0.9615225393631113, 3.572293717705263, 2.0812433290172887, -3.1266927292096027, 2.7399695962679163, 2.6575008265684725, -4.0, 3.9372579132980277, -2.301326440915467, -2.917830671092613, -2.9171700702993095, -2.6369774105567525, 3.472224543585885, 0.22043003740958522, -1.5096688277260963, 1.0391496570311936, 3.2027910045215706, -1.111131703821464, 0.24852425290993188, -1.58273996258022, 2.221195337595415, 1.2209927253400654, 0.4797458823475969, -1.256310089174624, -2.115175746380057, -2.6542875110686026, 2.682650386164613, -1.5366853437441794, -2.465577676027817, -2.882755321191879, -0.05386510343410522, -2.501601213323401, 2.5885833705658485, -0.3109143547184626, -2.5608202373816686, -3.0983139400367135, -1.1407471443698496, 2.262266526623125, 0.09824581511723002, -3.575116018849311, -0.8979876618887851, 1.369340567083829, 1.394358670129725, 2.86754004928085, 3.8316065450981913, -4.0, 1.8580481546117458, 1.866885483942223, 2.3951534606180336, -1.1960286551758972, -0.2732325912574954, 2.040909853040339, -0.23471801016938548, 0.7182451910086143, 3.2811005467973375, 2.5497603333995387, -2.3201289227069344, 3.7548748883972403, 3.5550625258383857, -0.9613199695358166, -1.9969468770121, 3.2928786884327748, -1.5683358045477644, -0.35002589616338997, 2.9418058149130615, -3.6530916977328545, -1.9067451925353247, -3.2637489645248454, 0.45715486648501164, 4.0, 1.9084538762473542, 1.5403442148083268, 2.549584505157647, 0.5850238678438542, 2.90763162375524, -0.8146890523706266, -0.9942607382628581, 1.1024151950671806, 3.3934699084027335, -3.9632893524976924, 1.5069433816320892, -1.7023914226742702, -0.3507356684917517, 1.0727142068490807, 1.6706838722220483, -1.9999330161259814, 3.039146441634743, 2.004357111549562, -2.104083993555995, -2.0119280479614674, 2.899367566713677, -1.420630491365534, 0.4278049625980478, 0.10885093402062672, 0.005079150109888052, 1.0907873129455148, 4.0, -2.670637614552825, 4.0, 4.0, 2.2518896291667394, 1.2908716315539406, 0.6842817164390462, 3.9753612254808792, 1.1856901345123632, 2.1334601039280696, -2.1712645583142804, 0.5549215095263228, 0.7388202301056416, 0.6502923787447004, -3.6688511698063606, 4.0, -3.6855291622523674, -2.3932805425314294, -1.3983496432395086, 3.650478429572904, 1.1294343658257489, -2.1103102323373, -3.993768292159287, -0.4173521005794653, 1.8486808063524578, 2.7982378803168384, 0.5244141524169904, 1.763565607632124, 0.24616168072908276, 0.5771601364508062, 0.35797288759905926, 0.8817515311789934, -2.1457014644275083, -1.9474661590203397, -3.917550192639544, -3.2581727892462915, -0.32033493078945385, -0.8925382666125304, -3.2076640549861772, 2.1774643064059953, 2.2577245007082363, -0.6793247135169455, -1.279339277062619, -1.829789462045268, 2.143894766267001, 3.476462281639888, -3.145086435462101, 0.447047290933815, 0.058402473885940026, -1.936446168720883, -1.6211803342010513, 1.3195353994170738, 1.3979890789919542, -0.7660007790487052, 3.615171001450452, -0.6951697257574648, -1.754279997281268, -2.4704329083268024, -0.12260045150167306, 1.161022853049604, -2.0300647155010463, -3.6538783012066647, 0.17311377520996485, 2.486410142863565, 2.27079976608892, -0.30010823106162837, -2.1423110886764194, 0.9099540742466985, -3.59858581394678, 1.6501169477030386, -2.9446149987011223, -3.322369830679676, -1.4088210780450339, -0.5520090988436224, 2.332676196128697, -1.7415727500311766, 3.9918527781252022, 0.027610433800830694, 3.538900201503704, -1.4986684508738624, -3.641325473119211, 3.5768111931593047, 2.329867985731783, 0.01187030870887878, -0.3370078164479823, 0.4433936861845539, -3.7762675597299205, 1.4170641603817848, -2.2096993104570957, 3.2608435400154145, 3.6122490010018766, 3.9307469372573642, 1.147193408048903, -1.2661971126774323, -1.5246299023850154, 0.010562714002624728, 2.180510109042832, -1.8890598343978724, 0.3551648065266529, 2.544122241898342, 0.18768516381521028, 1.8424951458833336, -0.4864592385792155, 1.583358678805339, -3.666044282367897, -1.7193133339878188, -0.6162384022134271, -3.327234978208665, 3.7268678464579534, 1.0423224370959574, 0.7800797989504622, 0.5749862492211939, 2.8556604343720595, 0.43742181029123, -0.8141480611741552, 1.6580830462300153, 1.0476409439400742, 1.8146979023263088, 0.311566166243231, -3.0614466952422656, -3.4587663205938317, 1.195971924868288, -2.7503007528626653, -0.5520034646102023, 0.6685988515068121, -2.054093193936117, -3.9328365741142135, 2.380001241080281, -2.157139964215682, 0.9271192466745841, 4.0, -1.816704306066789, -2.5989716708137913, -0.5335570756343891, 2.4702350637176007, -1.9135657205979306, 0.0015305415623732238, -1.5468051019192155, -2.927961697980474, -0.41655062165685547, -3.018186139848565, 2.770268016631774, -1.2982441295998, -1.5464754509416656, -0.2601546048406271, -0.3135863942027089, -1.0252885318803349, 2.2996159335768716, -2.135161688931996, 3.066825887686716, 0.6308446644602433, -3.3049954906610957, 3.5538704138096335, 0.8884587726675587, -0.12720869404751228, 3.746532614977823, 2.030367223155718, -3.089533511188299, 3.2987381998295686, -2.876345513938127, -2.545662286067228, -0.7574894965112426, 3.60210801899254, -0.35975955553155275, 2.546303640034668, 1.1703127392111838, 3.8586029054688002, -0.1906476419070552, 1.4507387838474457, -3.287084993365116, -0.6865823948481787, -0.6649926518274915, 0.5664208894057923, -2.381029815484431, -0.22958324610122693, -0.13881473333474972, 0.8268196215723815, -1.3211229511401776, 0.3631655009474332, -0.11502361399432824, -0.5456463682783205, -1.3403363937494122, 2.149818276731165, -0.950352976545261, 0.4278470476504684, 2.089447604314845, -1.8018201809438465, -1.5323032798809373, 2.08658866118703, 1.0903144394840185, 1.8354168650628848, -2.235567396922584, 2.2118535395942636, -3.984398693637554, -0.6925151373719461, 4.0, 3.5649483567058935, 0.5312745048536005, 2.102303873258324, -3.9315031813771384, 1.9698329835825423, -1.7607866546259896, 2.856633119110555, 0.6509000585250874, -1.3417703159840861, -3.2588096967124702, 2.0574725929362474, -2.4192027421326046, -2.7924065994829443, 4.0, 1.9110692379768082, -3.1506004575789204, 1.3116755350542357, 0.5146936400284778, 3.119397943168682, 1.1102086730578256, 1.4532315242902005, -2.3813099838176726, -2.9772347397498407, 0.17546601885042062, 0.19626779776856162, 2.431228088311929, 2.348656026971718, 2.3598996910347867, -3.03741536541813, 1.6349429583661401, 0.45349802085714286, 1.0576280869847392, 1.4841130870435515, -1.335117195504614, -3.036515922801867, 3.491606805557028, -0.13976676039572464, 3.2346371131999034, 3.518663260114935, -4.0, 3.087397498280831, -3.9262028419844945, 2.341389613845454, -2.104592146196633, 2.8286234400548143, 2.046961255691869, -0.5430379398670161, 2.4765485439565653, -0.34490368511364977, 1.8333428987011977, 0.2113863275138237, -3.538751188950428, 0.6827417882684248, -1.3590980691899952, 2.386488373936574, -3.7917280935492825, -2.5264889379984283, 3.557695704515276, 0.044902412353857175, 2.93981776946819, 4.0, -2.8877548633724643, 4.0, -0.9099211179466594, 4.0, -0.9295093013697346, 1.808180906612444, -1.3985314379364107, 2.766626627918106, 3.924930665906104, -3.6043729549272006, 2.0620711982155893, 2.3264344889324575, 0.7607951325398027, -0.39397646543601145, 0.8725139288016845, -1.549707310162344, 0.27286069852141687, -3.620283943642908, 2.335109601114227, 3.441140566622293, -3.4085844660366886, 0.17839811654778284, 0.4045976225044471, -0.35299347783980384, 2.189143945832147, -1.8156250930740634, 0.6278531340812539, 3.4486132453397804, -2.0793969760399063, -3.879670169909687, 3.1588345081459464, 4.0, -1.77947090422157, 2.707297897071884, 2.99168752622326, 2.2375703616119167, 2.8604897233326874, -2.2543289719297497, 1.5949723816230845, -4.0, -1.4837590605160607, -1.065918285026901, -2.6973130370909355, -4.0, -1.2264478970101729, -0.9050038841487573, 0.5909618918861953, 1.3447271866249686, -3.229360794138497, 0.9119208538155495, 0.7060597724182073, -3.06569676538135, -2.4696159789944363, -3.3606918041976135, 1.915401504569987, -3.222549172331535, 2.5517629306417775, 4.0, 0.11621901442286892, -0.6916969862328688, -2.0367873852616785, -1.3060874913226648, -0.23228595150915798, -2.30088024375825, 2.589232472640312, -1.8238111983079726, -3.1739554776692804, -1.2769950126909217, -1.3439493419381965, -3.203409427839052, 3.262097497988935, -2.0748003992752024, -2.174405927455096, 0.2205849511428564, 0.3402091356935636, 2.7502226766818447, 0.2499808842786935, 1.274428511391073, 2.7914468376090262, 1.9107300426666347, 1.9993138600334592, 3.173908754270025, -3.4195297568222, -4.0, 0.46964828548631177, 2.2551999283832775, 1.3305252689650202, -3.384405134054897, 3.9414341914025774, 2.855906305981464, -4.0, 2.8706658426126794, -3.894757391250035, -1.9060095524968874, -1.65974841612305, -1.9201923256775115, 0.21544270873987176, -0.9492097408764834, -1.7509831356352983, -2.944676636107435, 1.7216627265665747, 2.939193907362184, 0.6610344288165537, -1.9239956626327264, -2.547234274366924, -0.855299778738797, 2.591487132887521, 0.3092556598145494, -3.2132676413548062, -0.9146826736124255, -2.31521757009783, -0.01075074385243987, -0.06691680041408987, 1.999738751571344, 0.1088148480078639, 1.6156459637160843, 1.109977827593309, -1.1223679904806962, -0.996418610104224, 1.0848248623522605, 1.1739381878005586, -1.1171911195413267, -2.0176491275718083, -2.6274238747284597, 2.444526275308738, 1.864344364283216, 1.3762156531513692, 2.294879285489695, 1.8944748297337164, -3.306212619026618, -2.8119960848945436, 2.997006435711236, -1.9586169396167092, 1.6074172560125757, 0.4503659538012685, -2.803667551122563, -0.8132193883516298, 2.1819502542837435, -0.8358473951641198, 1.5061300333205614, 2.6547080097548132, 1.2289837207248997, 1.2216689567311816, 1.5120689706264172, -0.2697981946308415, 1.637255062781008, 1.8780276976468921, 0.6131796112930518, -1.2902146463846733, -1.551411836616937, 0.8536405699099922, -1.265850341790159, -0.042110794933071, -0.40089323112388664, 0.03785385586508254, -1.4021971673133673, 0.44509254610148163, 1.277149237812143, -1.1786464735125435, 1.4390261291407807, 2.9031136010599012, -2.6761217086668188, -4.0, 3.601728389623641, -1.199469665338354, -3.6577925168853316, -0.4131704248088831, -4.0, -3.5991237165501864, -3.3392464412893594, -1.529671497430052, -0.30820278899239784, 2.29156298186141, -2.816494001420031, -0.8359138717371836, 0.040158914649360264, 1.9507393053118733, -1.9451752736117929, 3.826896160407048, 4.0, 0.004061583753023125, 0.9044732203294118, 4.0, 2.803865774040541, 2.110313978189696, -2.325029584527048, -3.104014854757617, 2.867492497982571, 3.000979489741968, 4.0, -0.06887746968597389, 1.3634420281539321, 3.940225853448696, -3.755579075537315, -0.3512075309897424, 1.7710727353519538, 1.2404484053292868, -1.5035163894653627, 2.780244756958109, -0.5734441065849912, -2.2530367007234253, 1.7214672217827043, -2.9915676632036976, 0.565505077825629, -0.17494378352111403, -1.6814250876378074, 3.7024877042678765, 2.2430023212985617, -2.7161545617333456, 2.227642191091291, -2.1003806617974052, -3.807964887324832, 2.0396345127472992, -1.5399865600230098, 2.6044149582436926, -1.6576001679963048, -1.9416092234340043, -3.4208460402755474, -2.5517198564647234, -1.939834364059676, -0.351750847766032, 3.8638375641143408, -2.283607549706915, -1.2269321104062012, -1.9278881233591048, 3.868949374034383, 1.9169240567008587, 3.364493939127622, 0.12872296843054823, 2.324079940206916, -3.671176745850038, -2.7346243562176507, -3.6387298359858375, 2.074323535001617, 1.0406878701750994, -2.233165509535574, -3.6294646666048838, -2.6486952546755753, 3.6534971521977098, -3.7929838745724984, -1.4587540549924676, -3.6757534465523616, 1.3972345368760373, -1.8077899727949096, -2.083063386389721, -2.904255031232052, -2.3506497671227136, 3.8324685638826415, -2.851917527762879, 2.3612846001126533, -3.7506093236781486, -4.0, 3.551589110184209, -0.1079227879914728, 1.7747308693520365, -2.1703273556578035, 0.8498922758587746, 1.6381500740724686, 1.980824580250084, 0.30280316189637646, -3.622445503031935, -1.5778006243635272, 3.596047046386022, 1.0547134339086828, -1.3835753383686236, 1.8387634819608103, -0.3216963193168134, -0.1547323851266158, 1.0866332756891233, 3.444614743484396, 0.12088666759042557, 2.6275071663125993, 0.7040879557655211, -0.68544137926613, -0.5137557941319025, -2.110422908073782, -3.1220641828906137, 1.6135052259747253, 0.8949403915928208, 2.113105703125629, -2.1802738087224807, -0.20221355660609766, -1.5202674269672223, -0.21933778480361513, 3.6776989164512868, 1.3585497487231144, -2.4284541594341356, -1.0291560611114916, -2.0847584684750884, -3.3179839565488973, -2.042551220429024, 4.0, -3.322438567363749, 1.0400913668864502, -2.4858879746443208, 1.3251401142621606, -4.0, -1.6558990810927807, 0.4052194180057145, -1.6584950423640683, -2.409889013972632, -2.671069283033876, 0.5402812072004227, 3.6531368270059676, 4.0, 0.19479827221383111, -3.7774692043616565, -0.9124675273070489, -1.3377970521642857, -0.3274218955971423, -1.7184923096387006, 2.0951246143530944, 1.9846761798192718, -1.422548035464942, -1.6022909999255102, -2.6926405486846234, 0.9164434053318912, 0.8536044919903161, -4.0, 1.3324996308483175, 0.856022958545183, -1.6635248125138933, 3.167129285668239, -0.03708430498199459, -0.15926344944800563, 1.4791091845838908, -1.1485109600298242, -2.1681302117325103, -1.2019907488785033, 2.0357505228463717, -1.3605239468513248, 3.5191851048867746, 1.9810903482945308, 2.6185969867555845, 3.7095567856296983, 3.5087247024709534, 2.1566693435240625, -3.6937027081383538, -0.1536150975425371, -0.025969483242414507, 0.14066301587094637, 1.3001073321987993, -1.3776551376355426, -2.1916916058867337, -2.9754469795945577, 1.0086793249224564, -1.6548920889601153, 1.0818693481079726, -0.6827562700709345, 2.5884984480804096, -2.9290269802342297, 0.05768351720341418, -2.305027719390236, -3.523507789272081, 2.7870814900589447, 3.5172543525605313, 3.999997354820337, -0.26316278436412016, -2.4455135301991597, 0.7780667998810368, 2.412154332684371, 2.222388441861759, -2.7823428870919114, 2.8617689932219625, -0.053229839259243336, 2.910348468838783, -3.4758327206285835, -0.7429277338903385, -2.5307225915935994, 0.07271218062014881, -3.9999976107453454, 0.3339404334370583, -3.743688446404782, 1.5115676331734007, -2.341001248329257, -2.6387495291571765, -1.5352222690528396, -1.5676627475390819, 0.8013870642332005, -1.2758677625461334, -0.27168046991680694, -0.40900444471705366, -0.2587070288045976, 2.071983419075122, -3.940036623889506, -1.7238411512372263, 2.3896010029019563, -1.78208420650573, -3.1556544680756233, -1.3959049842049618, -1.181767109010589, -3.5951834751602814, 1.5077223351481173, -0.6127806079223046, -0.03304670548558942, 1.163963470379321, -3.052216693825325, 2.330800416010404, 1.0752282516383553, -2.132831336483539, -0.5298493212929494, 2.61231821690513, -1.880641940014398, 3.6898254860150024, -0.2015069859024978, -2.49501233062593, 0.29855721128913093, 1.4799757114421566, 3.5937898268893274, 2.3903737345094704, 2.191872264066441, 0.2654445553872324, 2.7226971261369624, -2.0142230706394346, -3.6959270308121814, -2.687911346619389, 0.996993527839601, 1.5114060651797858, 2.3090983447764293, 0.49591200809964375, -2.1894167065100962, 1.303961629923651, 0.8478905863225933, -3.8322384773774085, -0.22158595172184464, 3.7743574647528586, 0.41270586811705057, -1.2114041827659046, -1.477171510816432, -2.9301424684723747, 3.1889257514422287, 2.161416883841277, -3.4878298597351383, -2.2834107211327814, -1.2763511502697624, 1.4098577660994562, 0.0014526142767479048, -1.5063762288337716, 3.225799715307323, 0.22675758968373544, -2.2104949518076036};
        double[] chaosPsoList = new double[]{0.0, 4.0, -4.0, 4.0, 4.0, -4.0, -4.0, -4.0, -4.0, 4.0, 4.0, -4.0, 4.0, 4.0, 4.0, 4.0, 4.0, -4.0, -4.0, 4.0, 4.0, -4.0, -4.0, -0.3654823946299879, 4.0, -4.0, 2.314113845867312, 4.0, 2.6243668850770265, -4.0, -4.0, 0.4957004381609245, -0.1679822900254374, 4.0, 2.0339770355202322, 4.0, -3.95314420284875, 4.0, -0.7834510082675844, 1.6937883097968085, 4.0, -1.685465804408599, 1.2962540146671797, -1.3339950558828944, 0.6987677491554144, -0.034558998220261775, -4.0, 4.0, 4.0, -0.8966120351889821, -2.35466985909809, 4.0, 3.8206340542532544, 4.0, -0.5334481009019088, -4.0, 4.0, 4.0, 1.0801788251433406, -1.4491180526496232, 2.834028007128393, 3.792305668041319, 3.839763065322608, 1.1101885168515966, -1.6848954802024234, -1.3860624402554225, 2.1284339772023535, 1.6712563026372411, 2.6725081611877264, -0.4124059652386591, 2.9680476550866155, 0.5138374407577775, 4.0, 2.9137337803431924, -2.9386178107101557, -1.063439095949931, 3.91133850653244, -2.629441289283631, 2.7201615176302902, 0.2640136287696949, -2.8979173325158176, 4.0, 0.29754184177558807, 1.3242354277239965, 0.43383184141350883, -0.06883344384841422, -0.34248117456077637, 1.509098561381628, -0.0757590069529582, 1.3876454225130246, 2.374100165204449, 1.364759831236293, -0.17714777745449903, 2.1659369648909093, 2.618559201135771, 3.3668748455415325, 1.0837207416643533, -2.997588691964224, 1.8949777338489922, 0.014940232697230965, 1.6369561184872028, -2.6253975977446418, 0.466936875467847, 0.31946993785250277, 2.780215326791203, -1.9663122495234806, 0.09760350812526464, 0.5137789830958795, 3.2952559633674436, -3.090208236336777, 3.6355652365942674, 3.96679240567018, 0.5639026144139204, 3.504869556875899, -4.0, 3.3153379591534926, -2.273013787805196, 3.66409576874571, 2.9373209214553957, 3.776859791297065, 4.0, -1.0069915015713373, 0.09407634628307092, 0.06888597711679272, 3.505747919942826, 4.0, -0.4341318708817104, 1.1933046622413848, 2.476207094903361, 1.5585939647313969, -0.5521970141836465, 1.4115389592326582, 2.0344432914932775, 2.4457600972979976, 3.367247668816721, 2.362792277681157, 3.9601383709192772, 4.0, 2.2071411256534046, 1.3327757771389368, -2.928881589075194, 2.7161595830190017, 1.774405765729908, 1.9480985072892585, 1.6683750086523739, -1.761576535052518, 2.9591880623004174, -0.468754713617117, 0.3902853573540361, -3.110479371634168, -2.377625454126054, 2.2105579914703144, 1.2524432600690882, 2.9879769100586246, -3.3805854633682473, 0.9550131835239365, 4.0, 2.9734350876300426, -2.38834477450595, -2.3816914097413036, 2.280128497708884, 3.214508467268018, 2.790872171810226, 2.778612332797196, -0.2700580456505304, 2.938863027074528, 3.102085512909769, 2.0230837177584533, 3.589829896728331, 1.9150685833285774, 0.35872035596123636, 3.6771675786174582, 4.0, 2.0135003606919195, 0.8093060103604568, 4.0, 3.0594266432381265, 3.9020618470264323, 2.873593899565232, -3.7312246806694866, -2.3357497908998504, 3.7271128084121843, 4.0, -0.5494890533504144, -1.088654934195264, -1.2360834208780036, -1.2162534271246057, 2.5372508069855986, 0.28426228013675586, 0.29415239223417794, -0.9513486399676863, -2.3989575615431677, 1.22209340723033, -1.304608230274316, 1.5977458994218685, 4.0, 3.64640667310767, 0.2653729809444573, 2.809578150762495, -3.9320952991295868, -1.3002606915450428, 0.7450348740965618, 0.6189669460726221, 0.4265979271059979, 1.7474185823586585, 3.6330833328038032, 0.6316660256241516, 2.019544243456496, 2.871962030839101, 4.0, 1.522917523700304, 1.584677730735755, 2.4696017551913494, -1.2367826731706162, -1.192504654019331, 0.13639402443456136, 0.1050009677137564, -2.7769762023479085, -0.23809797679425576, 2.858588162115817, 0.8591431515392592, 4.0, -0.6981230302209025, 4.0, -2.846703837275492, 2.327422078837142, 2.20665420264814, 1.4625025299912942, 2.207997492195474, 4.0, 2.0376377858269, 2.6745792947401186, 4.0, 1.3849673771986535, -0.3052755318427009, 4.0, 0.4689292474733123, 1.757346123491226, -0.35990121717945234, 4.0, 3.331934619116107, 0.46966081104214374, 1.6646957146863595, 0.8178010724954831, 2.0519306464864737, 4.0, 4.0, 2.3499591160768247, 2.6637257881563476, 3.1786013862494085, -1.0144951556483246, -2.012105414007207, -0.45645938115972456, 2.5087184143613075, 1.7821764525928785, 4.0, -0.07542005718519154, 1.9100084937015778, -0.7831168543814163, -0.355672120426666, 2.3296898491575226, 2.332468437165199, 1.5383248642166985, 3.830306109691595, 0.24191295357131803, 2.2373302233631662, -1.5264449146116765, 1.169574278907632, 1.4034942198987832, 0.99322437786699, 1.8236667240943418, -1.3399031019788898, 1.8976795326493194, 1.3790652707965867, -0.07957045063791525, 3.5514492242986444, 1.284179305728909, -0.8604999621761524, 1.4717375890961546, 1.3898620727436055, 0.9007998333773529, 0.5772589180751357, -3.4187580388002434, 4.0, 3.963102040115654, 0.7736143326503719, 3.300707744381725, 4.0, 0.01858705708616543, 1.1987563714259677, 0.7194495757546892, 3.7773870257389293, 2.3401111287153014, 3.556424011264857, -1.3174203284660126, 1.8614171907573664, 2.2535597068382947, 3.6787316533881205, -1.5303624456124454, 3.2041593796076375, 2.5224819604450524, -2.2088760850815308, 3.968646727352858, -2.127412280192623, -1.2031305783877033, 0.4864286098756138, 3.9231615713141985, 3.9046195638251775, 3.7926726513554536, 2.8420596788452, 2.813861702668902, 1.2222322288968526, -1.4843299128582756, 2.340172714966745, 0.07615541662196249, 2.422594928154145, -1.2032368423187234, -2.2351605586376384, 0.01985576557939551, 3.1938141041024846, 1.658409864413277, -3.2411045050343734, 1.6169073030820438, 1.634793452787393, 2.881975514137616, 3.786397726147248, -0.40634706684229754, 2.3891508097153147, 2.8008051684940036, 3.575074852670438, 2.656113147570248, 2.3767238387746277, -1.7521696409984433, 4.0, 1.4755075540195444, -0.62982858036022, 4.0, 1.682521744809526, 0.7751902887139152, -0.35829674012846935, 2.0810217280256915, 2.908552146838784, 0.5636925635181527, -0.6601969512037913, 1.5535067796039415, 4.0, 2.9796251067270583, 0.8016871579907761, 0.09292040227745553, -0.8156406797014344, 0.8110325492022472, 2.8508663065832605, -0.739144831284935, 0.37892896156074873, 1.893461947107579, -0.40249731739279965, 1.6620259834621534, -2.231789429549087, 0.6738763186467085, -2.2069430721965393, -4.0, 3.708794462470699, -3.3481115721207484, 4.0, 3.7335129170975883, -0.05863049405677197, -1.4859196439540856, 2.0546762797731484, 3.602598991409603, 3.760115926973287, 4.0, 2.08236693976844, 1.1132137998434304, 2.6993969826357196, 1.8201287970047484, -3.084777590331248, 2.8020872767970113, 3.8202797886951294, 0.024845884537678522, 3.945923205272426, 3.411006181152609, 3.9061824351349728, -0.1844672326851134, 3.1967962577667457, 0.3024334365237299, 2.2957191415295046, 0.5314229855264018, 1.6198983721820626, 3.787609917327231, 3.9667909287858114, 0.800027095905345, 2.001654240848879, -3.594381172818298, 0.6659718062062688, 0.7307463629210328, 4.0, 1.643834048872182, 3.3645351655425, -2.378293776737036, 2.1101864910217305, 3.8222740846175083, -4.0, 0.6934533933757884, 4.0, 2.9528216749437255, -0.5778946363144438, 2.217753024280001, -2.4306624251348996, -2.673725437245573, -2.008806589319636, -1.721569498393401, 1.5925618909179873, 2.0253896235891427, 2.3093717635662028, 2.4907277773155436, 0.9019093132087538, 2.007714122274243, 3.6214922905556057, 0.5392285080934727, -0.7241248338624038, 0.1626427055095288, 3.65827820260493, 3.3025657587046613, 2.8649439987860745, 0.9792002692193018, 1.660500331727734, 1.1991864190807269, 0.45415166540238056, 0.03423587702851591, -0.9002131048266308, -0.8271282267073664, -2.461963424427086, 1.8119183797204723, 3.49701639217992, 0.7052214172223389, -1.4377529548837338, 0.9361998316369725, 2.1835225426775358, 1.65220322281706, 2.803784500633047, -0.5517990787732684, 0.7823536346917508, 0.5661440822191021, 2.4314753067094608, 3.9968989993190576, -1.1843124186567078, 0.7611688231051551, 0.9462776846144388, 2.1054638241756516, -1.6763805772350628, -4.0, 2.3623019007734256, 2.4172007190698688, 2.080205225501487, 3.518379786554442, 0.2324019053815008, 1.8880801850064248, 3.270424544972177, 1.6481129867641833, 4.0, 3.3025132042364898, 3.4370247349193135, 2.3019626342110975, 3.702389929485967, 4.0, 4.0, -0.7633302302662651, 1.5920457130686934, 3.9083783223176045, 1.338784541658879, -0.8349349840211392, 3.9928605310959098, -0.5156163398538643, 1.5936611262559925, -2.985648514424719, -0.09560774517975792, 4.0, 2.2890203047638353, 3.984804909147106, 0.7811746722010107, 4.0, 1.5200458707305236, -0.2734850795394703, 1.4322594358332847, 0.287455731590669, 2.0545994753535886, 2.850219483101298, 1.2918650551612714, 1.975921573653733, -2.4331337340437718, 3.9913289826268636, 4.0, 4.0, -0.9893309915688833, 4.0, 2.4830541062409353, 0.2657430317252305, 4.0, 0.20028192055954525, 1.7579689865380208, 1.6714324860786471, -0.7410859971381191, 1.9787482237678735, 2.619898200075101, 1.0792879944629075, 3.9634816879359835, 1.4535110333343715, -1.6408989736510866, -1.9715920959862487, 1.2743165866433717, 3.41324479255375, 1.372931870183062, 3.6934372105973035, -0.6243514771830675, -1.7799331061204753, -0.5941805132788551, 2.146997556639855, 2.8639277789783115, 2.8679550413029906, -2.3762727339273604, -1.4134516012561056, -4.0, 2.6417163166094464, 2.4316922570249364, 0.8829696185019443, 3.862169047007312, 3.7066448874195257, -0.9984197176143864, 3.5629767918174835, 2.91236029299914, 3.063679715542924, 0.9179615188602269, 0.17109006185740863, 3.2920878525520076, 2.6005048933800547, 1.3032668246615977, -0.23705864531200763, 0.4220347472388798, 0.8608864550805209, 2.0023586205968367, 4.0, 1.057391810979163, -1.7469649800342595, 2.29059365473237, -2.0538266790225603, 2.036859233075245, 2.806209494637449, -1.7118813920076483, -0.17595607074109051, 4.0, 2.385095314899841, 2.561585743943036, 0.46805953226352676, 1.9323166568908459, 2.6414325296817918, -3.501173308624595, -2.971087430893872, -3.28570594246221, 1.6231306536456032, 1.3926987447105001, 2.4689600017774285, 1.2693906407051172, 2.0007296457091344, 0.6438861785624357, 1.5762777454956152, 2.887496184793397, -2.9668664007876036, 2.4053694201601896, -1.8354310628143775, 2.5404659129617584, -0.4990100310498836, 1.4143529273241215, 1.0024475494733058, 4.0, 1.3001207168131594, 3.775388241084849, -1.7983331796445865, 1.61038138563916, -4.0, 1.8292288019552154, 0.006846147142829687, 0.903188803388452, 3.444046657652578, 1.9183317607410986, 1.4857827159430965, 1.8373377274521923, 4.0, 4.0, 3.5672883937674063, 1.8988451769381538, -2.2116602402878898, -1.2888140331470515, 1.1622363871435557, 3.95903777606177, 1.415399632373773, -2.1614888170427196, 1.9526729515741605, 3.1380445416291196, 3.4037702274481862, -0.010537905232068857, -0.7944055785068143, 3.5810282842763423, 3.700145095741442, -4.0, 3.642431716056096, 4.0, 0.22754932926154456, 1.6700283435616092, -4.0, -1.0341281724118396, -1.4719182866765324, 1.819519266614424, 3.1575850478131806, 1.040099557318463, -4.0, 1.7789951273625144, -0.8845821085275957, -1.7701489547650624, -1.7139076186876157, 2.4039452425055967, 3.311467107570008, -4.0, -1.4480615205725704, 2.960022871900616, -0.8760599023135826, 1.1318599918944803, 3.476325928844579, 2.4716269953412837, -1.7749683463926746, 1.609820363698703, 3.68412884923318, 3.654023859442986, 0.3448388525877727, 3.2145139219662187, 2.139400339170333, 2.4517355171025406, 2.2661455256388603, 4.0, 1.6606027729493664, -1.4149454667192107, 1.7956050528325311, 1.7093094636374342, 2.460934805289691, 0.6283162334879152, 2.678802279633332, 1.1310864179375817, -1.2968035650177026, 1.6231161081886416, 2.7527374168002634, 3.315571919403741, 3.971836439984227, 3.826763790384914, -0.14656600251172486, -1.8017281551703153, 2.5040833519191192, 2.840543255394223, 1.0696435233627344, 2.4279722458515476, -2.6999763769016574, 4.0, 3.5911538444341446, 4.0, -3.6766774627806953, 2.615645459339384, 0.4430738546535652, 2.8377644032377924, 3.634013035093947, 2.500073115779494, 0.2551002839063602, 1.9343862979057251, -0.7453339502278766, 0.5928442293505777, 3.2710648448695823, 3.2408729902789783, 4.0, 1.0246830061005248, 3.1184308418673474, 4.0, 2.024890519653269, 4.0, 1.6115651484908542, 2.1684559129105643, -1.2633201045150493, 1.3499022991131011, 2.5092464732450317, 3.9577079266656665, 0.5001465751602947, 0.36540976898425914, 0.45341005746064883, 3.6122493052235414, 1.366563916679902, 3.9170529838618013, 1.9601693355635335, 0.460518173004632, 3.3807815787154185, -2.459553527842906, -0.8986068377509652, 2.5414422691645377, -2.1991512702921296, 4.0, -0.16761268264671944, 1.544665630641079, 3.424373912260403, 1.215050825012663, 2.9247892324281293, -1.66592800579492, 4.0, 4.0, -1.6270978716619013, 0.8232825594783709, 2.7726792637780364, 4.0, 2.2576372344523894, -1.7217031241076002, -0.7668144757470002, 1.7310052389025334, 3.940259955671536, 1.9128078434774878, 0.8032782064128988, -3.2434787983210334, 1.2514262696230414, -0.37497585977935427, 2.2379966273742578, 1.9640968085009682, 2.867237409885174, 1.3721228703347181, 3.8109713316279605, 1.8351496489680268, 4.0, 1.1164314928743901, 2.9569179620794834, -2.542924700881568, 0.5880420694116155, 3.6326402696137334, 0.5347435676095605, -3.6227148040110055, 4.0, 4.0, 1.0138259412614583, 2.35481272638361, 0.41005457473200196, 2.9368535545242094, 1.9745683683885464, -0.4220136581957725, 3.6924796600704357, 0.4456477721968577, 4.0, 0.31788173356962207, 3.859774789945031, 4.0, 3.8205478504835813, 3.6553669869360803, 1.7760437524609496, 1.8835307212458963, -4.0, 2.316907038006088, 1.695425466778048, 3.2734512183643285, 2.654423818854389, -2.149142538525072, 2.097066405959254, -1.3258956665758592, 3.9111840538189178, 3.2934642494003628, 2.9071646802524445, 1.5267431954178639, 0.9727939341215627, 1.094944374550988, -0.018255860520934662, -1.5927684048405117, 1.2462635005201157, 3.458744520533155, 3.915501545331682, 3.1424140657521638, 4.0, 1.0595141571383178, -0.7328232945243908, 3.891290824126348, 0.37248259656069665, 2.39796956189517, 1.385173708919696, 2.703068997055083, -0.005111197711751959, 3.3201410477975104, 1.2167664388473194, 3.8612677710630963, 1.3489649901884604, 2.8415022084615638, -0.6471448052475387, 3.553989280164832, -0.19208516383470106, -2.1346452814951657, -1.439088938960502, -1.6345170897617127, 0.2161123730669769, 2.2007058141361244, -3.963536640106528, 1.4528221448226297, 0.6359186093559352, 1.0401412593190011, -0.5580079722729152, 3.7174243772873163, 0.6594450907154332, 1.1126642937528606, 0.8053367452687661, -2.352274152913024, -1.3066450196470591, 3.9631100728622344, 4.0, 2.710751434133586, 3.30282192255332, -0.892133649025583, 0.23633449995937086, -2.9474576492360516, 2.750546426612816, 1.4213172338231626, 2.2995347589358492, 0.3185708297008417, 1.8640277340598854, 3.9918854803232833, -1.3404380600237957, 1.7613389581326597, 0.8339530952089459, 2.8776413629359423, 3.3029190608704337, 4.0, 2.819860801426074, 0.42970843968686867, 3.986091482265754, 1.3629118011915968, 2.5554076751211485, 0.9966223453759224, 3.625826156202277, -2.0802041967588027, -0.2601590428313935, 3.370038223665718, 4.0, 1.7802515516966895, 0.28217137723182584, 1.449872551747933, -2.4233404698990015, 1.4359479050508397, 4.0, 3.768203842437025, -0.27982143792736736, -1.3231698457470746, 3.461969062333193, 1.4166454711921141, 1.5276528933721578, 0.905857989823357, 4.0, 3.3726967981223535, -0.09763838963359975, 1.6778809355505035, 0.3413826553408083, 1.8004967690502773, 1.6925850802265345, 1.5721853505204104, 1.862413474471311, 0.24258856316757196, 0.3458164368007318, -0.20343581620801865, 2.930891827731651, 1.3290609090232937, 0.48077812643278556, -1.86283013946969, 2.358680086810423, -0.007409601175026676, 4.0, 1.4204475042318847, 2.722808276358074, 2.3471311183165358, 1.563243284181148, -0.46803356739493557, 2.255219199697538, 1.0881458830044966, 1.0801986671557422, 1.4852910939053414, -1.5994060817929379, -1.8454509360617826, -1.2090668938555382, 1.279551770802235, 0.8574610601059589, 2.6809863473058493, -0.22309117611672447, 1.6618274205784536, 3.048142573723001, 1.6671080126025366, 3.2831987420453888, 3.830011370981147, 3.3804698588318836, 4.0, -0.7142917342807359, -1.02563106769497, 4.0, 3.1671676531332396, 0.8426244748865573, 2.0024267863062795, 0.5693355950850992, 2.2160411742546975, -0.24144428912228771, 0.7636843073190267, 0.6206158355250934, 2.8718759489481296, 0.15281567190930076, 3.7222638675670683, 3.428851552526477, 2.7217447447498158, -1.4136904092390425, 3.903293053391033, -0.2043797394838767, 3.67011019089922, 1.956990661165312, -1.6468643233155489, 1.2610848594703943, 2.4698018289674533, 3.1292239684288843, 3.997442739659326, 0.4594298401447867, 2.9969544313214427, 4.0, 4.0, 3.983701799850981, 3.2058202163447396, 4.0, 0.7647163621409158, 3.4407971831007984, -0.9494763743417644, 2.133239903262544, 1.8319641933890818, -3.551444379479661, 1.208763222372858, 3.1469599021171972, 4.0, 2.5521622846753904, 3.1876859091058742, 0.6600833657166094, 0.3188613678425479, 0.21835558211619155, 4.0, -0.17519095624167355, 1.3052356704721408, 0.8933935554538729, -2.7197524231348766, -0.9832804563692283, 0.8702905430401328, 4.0, -2.8198054088195854, 0.18645328343134174, -0.5997999397546749, 2.4551567499511227, 2.694849633795857, 1.0565574957538924, 2.537198963601519, -1.3841803964416093, 2.1210991476254213, 2.7274913835943653, 3.1538767773258325, 1.9076904806682013, 3.163131787412539, 3.8703383573190684, 2.6268482845961154, 2.1591378358179494, 3.933424812640135, 2.590366158415441, -0.7621608784446589, 0.14632697274662032, -1.4279542463906192, -1.4491354934850096, 1.6360518550266159, 4.0, 1.1992849611367704, -0.5407786606252787, -1.2826047165128125, 3.8018783482025684, 0.9427517475316873, 0.7292897939815791, 2.681398823672504, 2.320499404021382, 3.6274518474937008, 1.5141106098091008, 1.6493550628495468, 0.2500723500554242, -0.12794740309322655, 3.2846562851382353, 2.6527497951611347, 0.5353378182367816, 2.1122917791626556, 2.990881152979633, 2.151648114140333, 3.5164165856076908, 0.7125446452456671, 3.9199774201137902, 4.0, -1.678375746626791, -0.44446142855498344, 4.0, 1.767269437464695, 3.562656068301617, 4.0, 2.9417401518238826, 3.8887284362934333, 0.46848417607369053, -1.6378634414057134, -4.0, -3.6363374349533513, 1.3302171013490334, 2.544255270483229, 0.5883675970738117, 0.8544276018340885, 2.980434593620536, 4.0, -0.8359006670064744, -0.4401803194614535, -3.6751312403804572, 0.8388146698824046, 1.1826057985257192, 4.0, 0.3647849942358556, 4.0, 4.0, 2.419971413056159, 0.6463897079512477, -0.5312507386222223, -0.5531297781044395, -1.727469631246344, 2.0430038870229894, 4.0, 2.699689811786259, -0.7828131207075232, 1.4825763494868813, 0.5253299261320414, 0.9797776511842007, 2.531394377343317, -1.1730738872502673, 2.577636603644406, 2.546568861878757, 3.566236173250638, 2.6796711726477227, 2.5513005679439043, 0.38161179038158477, 4.0, -1.3386203978022475, 0.37071712056328027, 2.784711925572611, 2.8373665958530983, -1.2961464398076765, 2.741244889139127, -0.8395434707806098, -0.025234861006832546};
//        scheduleAns = optList;

//        scheduleAns = doubles.clone();

        if(ids.length > 1){
            opt_pso_list.add(run.getDouble("best_fit"));

            System.out.println("********************** RESULT **********************");
//            outputResList(pso_list, "pso_list : ");
            outputResList(chaos_pso_list, "CHAOS_pso_list : ");
            outputResList(ch_pso_list, "ChPSO_list : ");
            outputResList(opt_pso_list, "optimized_pso : ");
//            outputResList(gene_list, "gene: ");
            System.out.println("********************** END **********************");
        }

//        startTime = System.currentTimeMillis();
//        Population population = new Population(machinesCostInfo, performanceJSON, ids);
//        run = population.run(500);
//        endTime = System.currentTimeMillis();
//        best_sovs = run.getObject("best_sov", double[].class);
//        System.out.println("******************************** GENE ********************************");
//        System.out.println("time consume: " + (endTime-startTime));
//        System.out.println(Arrays.toString(best_sovs));
//        System.out.println(run.getDouble("best_fit"));
//        System.out.println("******************************** END ********************************");

        System.out.println(Arrays.toString(scheduleAns));
        if(startStatus == 1){
            for (int i=0; i < scheduleTaskList.size(); i++){
                int machine_id = (int) Math.abs(scheduleAns[i]);
                if(machine_id > 3){
                    machine_id = 3;
                }
                SendTask(scheduleTaskList.get(i), machine_id);
            }
            System.out.println(" " + Arrays.toString(ids));
        }
    }

    private void outputResList(ArrayList<Double> list, String name){
        System.out.println(name + list);
        System.out.println(DictionaryUtil.getAvgByList(list) + " " + DictionaryUtil.getStdDevByList(list));
    }

    private double[] NSGA_III(JSONObject machinesCostInfo, JSONObject performanceJSON, Long[] ids){
        long startTime = System.currentTimeMillis(), endTime;
        Population population = new Population(machinesCostInfo, performanceJSON, ids);
//        JSONObject run = population.run(500);
//        endTime = System.currentTimeMillis();
//        double[] best_sovs = run.getObject("best_sov", double[].class);
//        System.out.println("******************************** GENE ********************************");
//        System.out.println("time consume: " + (endTime-startTime));
//        System.out.println(Arrays.toString(best_sovs));
//        System.out.println(run.getDouble("best_fit"));
//        System.out.println("******************************** END ********************************");

        double[] res = new double[0];

        try {
            startTime = System.currentTimeMillis();
            JSONObject aiResult = AiEnhanceTool.getAiResult(AiEnhanceTool.NSGA3, ids, machinesCostInfo, performanceJSON);
            endTime = System.currentTimeMillis();
            String[] split = aiResult.getString("res").split(" ");
            System.out.println("******************************** NSGA-III ********************************");
            System.out.println("time consume: " + (endTime-startTime));
            System.out.println(Arrays.toString(Arrays.copyOf(split, split.length - 2)));
            System.out.println(Double.parseDouble(split[split.length-1]) + Double.parseDouble(split[split.length-2]));
            System.out.println("******************************** END ********************************");

            if(ids.length > 1) {
                gene_list.add(Double.parseDouble(split[split.length-1]) + Double.parseDouble(split[split.length-2]));
            }

            res = new double[split.length-2];
            for(int i=0; i<res.length; i++){
                res[i] = Double.parseDouble(split[i]);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }

        return res;
    }

    private void SendTask(TaskDetailVO vo, int i) throws Exception{
        String url = serverList.get(i) + CMD_TAIL;
        vo.setTaskProgress((double)(1000 + i));
//        String msg = "*************************\n" + schedule_type + " send a task to : \n" + url + "\n" + vo.getTaskId() + " " + vo.getTaskName() + "\n" + "*************************";
//        System.out.println(msg);
        CloseableHttpClient client = HttpClientBuilder.create().build();
        HttpPost httpPost = new HttpPost(url);
        httpPost.setHeader("Content-Type", "application/json;charset=UTF-8");
        JSONObject jsonObject = (JSONObject) JSONObject.toJSON(vo);
        StringEntity entity = new StringEntity(jsonObject.toJSONString(), "UTF-8");
        entity.setContentType("application/form-data");
        httpPost.setEntity(entity);

        CloseableHttpResponse execute = client.execute(httpPost);
        HttpEntity httpEntity = execute.getEntity();
        String res = EntityUtils.toString(httpEntity);
        client.close();
//        System.out.println("*************RESULT****************");
//        System.out.println(res);
//        System.out.println("*************RESULT****************");
    }

    public void AllocateTask(TaskDetailVO vo) throws Exception{
        ArrayList<TaskDetailVO> scheduleTaskList;
        synchronized (waitingQueue){
            waitingQueue.add(vo);
        }
        synchronized (TaskScheduleAllocator.class){
            synchronized (waitingQueue){
                if(waitingQueue.size() < TaskSendThreshold){
                    return;
                }
                scheduleTaskList = new ArrayList<>(waitingQueue);
                waitingQueue.clear();
            }
            if(scheduleTaskList.isEmpty()){
                return;
            }
            JSONObject machinesCostInfo = getMachinesCostInfo();
            if("tanxin".equals(schedule_type)){
                TanXinSchedule(scheduleTaskList, machinesCostInfo);
            }else if("liziqun".equals(schedule_type)){
                LiziqunSchedule(scheduleTaskList, machinesCostInfo);
            }else{
                LunXunSchedule(scheduleTaskList);
            }
        }
    }

    public static JSONObject getSystemInfo(String promQL, String tail) {
        RestTemplate restTemplate = new RestTemplate();
        try {
            return restTemplate.getForObject(promQL, JSONObject.class, tail);
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }

    public static JSONObject sendGetRequest(String url){
        CloseableHttpClient client = HttpClientBuilder.create().build();
        HttpGet httpGet = new HttpGet(url);
        httpGet.setHeader("Content-Type", "application/json;charset=UTF-8");
        try {
            CloseableHttpResponse execute = client.execute(httpGet);
            HttpEntity httpEntity = execute.getEntity();
            String s = EntityUtils.toString(httpEntity);
            JSONObject json = JSONObject.parseObject(s);
            client.close();
            return json;
        } catch (IOException e) {
            e.printStackTrace();
        }
        return null;
    }

    private JSONObject getMachinesCostInfo(){
        JSONObject res = new JSONObject();
        for(int i=0; i<serverList.size(); i++){
            String url = serverList.get(i) + GET_COST_TAIL;
            JSONObject jsonObject = sendGetRequest(url);
            res.put(machineName.get(i), jsonObject);
        }
        return res;
    }

    public static String getSchedule_type() {
        return schedule_type;
    }

    public static void setSchedule_type(String schedule_type) {
        TaskScheduleAllocator.schedule_type = schedule_type;
    }

    public static void setStartStatus(Integer startStatus) {
        if(startStatus == null){
            startStatus = 0;
        }
        TaskScheduleAllocator.startStatus = startStatus;
    }
}
